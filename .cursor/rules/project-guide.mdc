---
description: SafeMeals í”„ë¡œì íŠ¸ ë©”ì¸ ê°€ì´ë“œ (í”„ë¡œì íŠ¸ êµ¬ì¡°, ê¸°ìˆ  ìŠ¤íƒ, í•µì‹¬ ê·œì¹™)
globs:
alwaysApply: true
---

# SafeMeals í”„ë¡œì íŠ¸ ê°€ì´ë“œ

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡° (ëª¨ë…¸ë ˆí¬)

### ì „ì²´ êµ¬ì¡°
```
safemeals-monorepo/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                    # Next.js ì›¹ì•± (ì›¹ë·°ìš©)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/            # Next.js App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ features/       # ê¸°ëŠ¥ë³„ ëª¨ë“ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ components/     # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ commons/        # ì „ì—­ ë ˆì´ì•„ì›ƒ, ìƒìˆ˜, ìŠ¤í† ì–´
â”‚   â”‚   â”‚   â”œâ”€â”€ lib/            # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”‚   â””â”€â”€ hooks/          # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ mobile/                 # React Native ë„¤ì´í‹°ë¸Œ ì•±
â”‚       â”œâ”€â”€ app/                # Expo Router íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ…
â”‚       â”œâ”€â”€ components/         # ë„¤ì´í‹°ë¸Œ ì»´í¬ë„ŒíŠ¸ (WebViewScreen ë“±)
â”‚       â”œâ”€â”€ android/
â”‚       â”œâ”€â”€ ios/
â”‚       â””â”€â”€ package.json
â”‚
â””â”€â”€ packages/
    â””â”€â”€ shared/                 # ê³µìœ  íŒ¨í‚¤ì§€
        â””â”€â”€ src/
            â”œâ”€â”€ bridge-protocol/# ì›¹ë·°-ë„¤ì´í‹°ë¸Œ í†µì‹ 
            â”œâ”€â”€ types/          # ê³µí†µ íƒ€ì…
            â””â”€â”€ constants/      # ê³µí†µ ìƒìˆ˜
```

### íŒ¨í‚¤ì§€ ì„¤ëª…
- **apps/web**: Next.js 14 ì›¹ ì•± (ì›¹ë·°ë¡œ ì‚¬ìš©)
- **apps/mobile**: React Native ë„¤ì´í‹°ë¸Œ ì•± (Expo Router)
- **packages/shared**: ê³µìœ  íƒ€ì… ë° ë¸Œë¦¿ì§€ í”„ë¡œí† ì½œ

## ğŸ“¦ ê¸°ìˆ  ìŠ¤íƒ

### ì›¹ ì•±
- Next.js 14, TypeScript, Tailwind CSS
- shadcn/ui + Radix UI
- Zustand + React Query
- React Hook Form + Zod
- lucide-react ì•„ì´ì½˜

### ëª¨ë°”ì¼ ì•±
- Expo ~52.0, Expo Router ~4.0
- React Native, react-native-webview
- @safemeals/shared ë¸Œë¦¿ì§€ í”„ë¡œí† ì½œ

## ğŸ”‘ í•µì‹¬ ê·œì¹™

### ì›¹ ì•±
- âŒ CSS Module â†’ âœ“ Tailwind CSS
- âŒ URL í•˜ë“œì½”ë”© â†’ âœ“ `src/commons/constants/url.ts`
- âŒ í…ìŠ¤íŠ¸ í•˜ë“œì½”ë”© â†’ âœ“ `useTranslation` í›…
- âœ“ Radix UI Dialog (ëª¨ë‹¬/ë‹¤ì´ì–¼ë¡œê·¸)
- âœ“ data-testid ì§€ì • (í…ŒìŠ¤íŠ¸)
- âœ“ `isNativeApp()` ì²´í¬, `nativeBridge` ì‚¬ìš© (ë¸Œë¦¿ì§€)

### ëª¨ë°”ì¼ ì•±
- âœ“ `@safemeals/shared/bridge-protocol` ì‚¬ìš©
- âœ“ `nativeBridge` ìœ í‹¸ë¦¬í‹° ì‚¬ìš©
- âœ“ Expo Router íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ…
- âœ“ StyleSheet.create (Tailwind ì‚¬ìš© ì•ˆ í•¨)

## ğŸš« ê¸ˆì§€ ì‚¬í•­
- CSS Module, react-portal ì§ì ‘ êµ¬í˜„
- position: absolute ë‚¨ìš©, !important ì‚¬ìš©
- ëª…ì‹œë˜ì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (JEST ë“±)

## ğŸ“ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### ì›¹ ì•±
- `src/components/ui/`: shadcn/ui ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ (ìˆ˜ì • ìµœì†Œí™”)
- `src/components/ui/button-legacy, input-legacy`: Legacy (ì‹ ê·œëŠ” shadcn/ui ì‚¬ìš©)
- `src/components/common/`: í”„ë¡œì íŠ¸ ê³µí†µ ì»´í¬ë„ŒíŠ¸
- `src/features/`: Feature-based Architecture (auth, scan, dashboard, profile)
- `src/commons/`: ì „ì—­ ë ˆì´ì•„ì›ƒ, ê³µí†µ ë¡œì§, ìƒìˆ˜, ìŠ¤í† ì–´

### ëª¨ë°”ì¼ ì•±
- `app/`: Expo Router íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ…
- `components/`: ë„¤ì´í‹°ë¸Œ ì»´í¬ë„ŒíŠ¸ (WebViewScreen ë“±)
- ë„¤ì´í‹°ë¸Œ í™”ë©´: app/ ë””ë ‰í† ë¦¬ì— ì§ì ‘ êµ¬í˜„
- ì›¹ë·° í™”ë©´: `app/webview/[...path].tsx` ì‚¬ìš©

## ğŸ”„ ìƒíƒœ ê´€ë¦¬

### ì›¹ ì•±
- ì„œë²„ ë°ì´í„°: @tanstack/react-query
- ì „ì—­ í´ë¼ì´ì–¸íŠ¸: `src/commons/stores/` Zustand
- ë¡œì»¬: useState (ìµœì†Œí™”)
- í¼: react-hook-form

### ëª¨ë°”ì¼ ì•±
- ë„¤ì´í‹°ë¸Œ: React Native ê¸°ë³¸ (useState, useReducer)
- ì „ì—­: í•„ìš”ì‹œ Context API ë˜ëŠ” Zustand
- ì›¹ë·°: ì›¹ë·° ë‚´ë¶€ì—ì„œ ê´€ë¦¬

## ğŸŒ‰ ë¸Œë¦¿ì§€ í”„ë¡œí† ì½œ

### ê¸°ë³¸ ì‚¬ìš©ë²•

ì›¹ë·° â†” ë„¤ì´í‹°ë¸Œ í†µì‹ ì€ `packages/shared/src/bridge-protocol` ì‚¬ìš©

**ì›¹ì—ì„œ ë„¤ì´í‹°ë¸Œ í˜¸ì¶œ:**
```typescript
import { nativeBridge, isNativeApp } from '@safemeals/shared/bridge-protocol';

// ë„¤ì´í‹°ë¸Œ ì•±ì¸ì§€ í™•ì¸
if (isNativeApp()) {
  // ë°”ì½”ë“œ ìŠ¤ìº” ìš”ì²­
  nativeBridge.scanBarcode();
  
  // ë„¤ì´í‹°ë¸Œ í™”ë©´ìœ¼ë¡œ ì´ë™
  nativeBridge.navigate('Camera');
  
  // ë„¤ì´í‹°ë¸Œ ì•ŒëŸ¿ í‘œì‹œ
  nativeBridge.showAlert('ì•Œë¦¼', 'ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤');
  
  // í–…í‹± í”¼ë“œë°±
  nativeBridge.haptic('medium');
  
  // ê³µìœ 
  nativeBridge.share('ì œëª©', 'ë‚´ìš©', 'https://...');
}
```

**ë„¤ì´í‹°ë¸Œì—ì„œ ì›¹ë·°ë¡œ ë©”ì‹œì§€ ì „ì†¡:**
- WebViewScreenì˜ handleMessage ì‚¬ìš©
- `packages/shared/src/bridge-protocol/types.ts`ì˜ íƒ€ì… ì •ì˜ ì¤€ìˆ˜

### ë¸Œë¦¿ì§€ ë©”ì‹œì§€ ì¶”ê°€ ë°©ë²•

1. `packages/shared/src/bridge-protocol/types.ts`ì— íƒ€ì… ì¶”ê°€
2. ì›¹ì—ì„œ ì‚¬ìš©ì‹œ `web-bridge.ts`ì— í¸ì˜ í•¨ìˆ˜ ì¶”ê°€
3. ë„¤ì´í‹°ë¸Œì—ì„œ `WebViewScreen.tsx`ì— í•¸ë“¤ëŸ¬ ì¶”ê°€

## ğŸŒ ë‹¤êµ­ì–´

### ì›¹ ì•±
- `src/hooks/useTranslation.ts` í›… ì‚¬ìš©
- ë²ˆì—­ ë°ì´í„°: `src/lib/translations.ts`
- í•˜ë“œì½”ë”© ê¸ˆì§€, ë²ˆì—­ í‚¤ ì‚¬ìš©
- ìƒˆ í…ìŠ¤íŠ¸ ì¶”ê°€ ì‹œ ëª¨ë“  ì–¸ì–´ ë²ˆì—­ ì¶”ê°€

### ëª¨ë°”ì¼ ì•±
- ì›¹ë·° í™”ë©´: ì›¹ ì•±ì˜ ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ì‚¬ìš©
- ë„¤ì´í‹°ë¸Œ í™”ë©´: í•„ìš”ì‹œ ë³„ë„ êµ¬í˜„

## ğŸ¨ ìŠ¤íƒ€ì¼ë§

### ì›¹ ì•±
- Tailwind CSS ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ ìš°ì„ 
- ìƒ‰ìƒ: globals.css CSS ë³€ìˆ˜ ë˜ëŠ” Tailwind í…Œë§ˆ
- ì£¼ìš” ìƒ‰ìƒ: Primary (#2ECC71), Danger, Caution
- ë°˜ì‘í˜•: ëª¨ë°”ì¼ ìš°ì„  (sm: 640px, md: 768px, lg: 1024px)

### ëª¨ë°”ì¼ ì•±
- React Native StyleSheet.create
- Tailwind CSS ì‚¬ìš© ì•ˆ í•¨ (ì›¹ë·° ë‚´ë¶€ëŠ” Tailwind ì‚¬ìš©)
- Platform.select (í”Œë«í¼ë³„ ìŠ¤íƒ€ì¼)
- SafeAreaView (ì•ˆì „ ì˜ì—­)

## ğŸ“ íŒŒì¼ ë„¤ì´ë°

### ì›¹ ì•±
- ì»´í¬ë„ŒíŠ¸: kebab-case (safety-card.tsx)
- í´ë”: kebab-case (auth-login/)
- ìƒìˆ˜: kebab-case (enum.ts, url.ts)
- í›…: camelCase (useTranslation.ts)

### ëª¨ë°”ì¼ ì•±
- Expo Router íŒŒì¼: kebab-case (camera.tsx)
- ì»´í¬ë„ŒíŠ¸: PascalCase (WebViewScreen.tsx)
- í´ë”: kebab-case

## ğŸ¯ í™”ë©´ êµ¬í˜„ ë°©ì‹

### í™”ë©´ë³„ êµ¬í˜„ ì „ëµ

| í™”ë©´ | ë°©ì‹ | ì´ìœ  |
|------|------|------|
| ìŠ¤í”Œë˜ì‹œ | ë„¤ì´í‹°ë¸Œ | ì•± ì‹œì‘ ì†ë„, ë¸Œëœë”© |
| ì¹´ë©”ë¼/ìŠ¤ìº” | ë„¤ì´í‹°ë¸Œ | ì¹´ë©”ë¼ ì ‘ê·¼, ì„±ëŠ¥ |
| ëŒ€ì‹œë³´ë“œ | ì›¹ë·° | ë³µì¡í•œ UI, ë¹ ë¥¸ ì—…ë°ì´íŠ¸ |
| ì˜¨ë³´ë”© | ì›¹ë·° | ë³µì¡í•œ í¼, A/B í…ŒìŠ¤íŠ¸ |
| í”„ë¡œí•„ | ì›¹ë·° | ìì£¼ ë³€ê²½ë˜ëŠ” ê¸°ëŠ¥ |
| ìŠ¤ìº” ê²°ê³¼ | ì›¹ë·° | ë³µì¡í•œ UI, ë°ì´í„° í‘œì‹œ |
| ì„¤ì • | ë„¤ì´í‹°ë¸Œ | ê¶Œí•œ ê´€ë¦¬, ì‹œìŠ¤í…œ ì—°ë™ |

### ì„ íƒ ê¸°ì¤€
- **ë„¤ì´í‹°ë¸Œ í™”ë©´**: ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥ í•„ìš” (ì¹´ë©”ë¼, ê¶Œí•œ ë“±)
- **ì›¹ë·° í™”ë©´**: ë³µì¡í•œ UI, ìì£¼ ì—…ë°ì´íŠ¸ë˜ëŠ” ê¸°ëŠ¥
- **ì„ íƒ ê¸°ì¤€**: ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥ í•„ìš” ì—¬ë¶€, ì—…ë°ì´íŠ¸ ë¹ˆë„, UI ë³µì¡ë„

## ğŸš€ ì‹œì‘í•˜ê¸°

### ê°œë°œ í™˜ê²½ ì„¤ì •

```bash
# 1. íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ì„¤ì¹˜
npm install -g pnpm

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
pnpm install

# 3. ì›¹ ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm dev:web
# ë˜ëŠ”
cd apps/web && pnpm dev

# 4. ëª¨ë°”ì¼ ì•± ì‹¤í–‰
# iOS
cd apps/mobile
npx pod-install
pnpm ios

# Android
cd apps/mobile
pnpm android
```

## ğŸ› ï¸ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ë„¤ì´í‹°ë¸Œ í™”ë©´ ì¶”ê°€

1. `apps/mobile/app/` ë””ë ‰í† ë¦¬ì— í™”ë©´ íŒŒì¼ ìƒì„± (ì˜ˆ: `camera.tsx`)
2. Expo Router íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ… ìë™ ì¸ì‹
3. í•„ìš”ì‹œ ë¸Œë¦¿ì§€ ë©”ì‹œì§€ íƒ€ì… ì¶”ê°€

### ìƒˆë¡œìš´ ì›¹ë·° í™”ë©´ ì¶”ê°€

1. `apps/web/src/app/` ì— í˜ì´ì§€ ìƒì„± (ì˜ˆ: `app/new-page/page.tsx`)
2. `apps/mobile/app/webview/[...path].tsx`ê°€ ìë™ìœ¼ë¡œ ë¼ìš°íŒ… ì²˜ë¦¬
3. í•„ìš”ì‹œ `packages/shared/src/bridge-protocol/types.ts`ì˜ `WEBVIEW_ROUTES`ì— ë§¤í•‘ ì¶”ê°€

### ë¸Œë¦¿ì§€ ë©”ì‹œì§€ ì¶”ê°€

1. `packages/shared/src/bridge-protocol/types.ts`ì— íƒ€ì… ì¶”ê°€
2. ì›¹ì—ì„œ ì‚¬ìš©ì‹œ `web-bridge.ts`ì— í¸ì˜ í•¨ìˆ˜ ì¶”ê°€
3. ë„¤ì´í‹°ë¸Œì—ì„œ `WebViewScreen.tsx`ì˜ handleMessageì— í•¸ë“¤ëŸ¬ ì¶”ê°€

## ğŸ¯ ì‘ì—… ìˆœì„œ

1. í”¼ê·¸ë§ˆ/ìš”êµ¬ì‚¬í•­ ë¶„ì„
2. ë„¤ì´í‹°ë¸Œ vs ì›¹ë·° ê²°ì • (í™”ë©´ë³„)
3. package.json í™•ì¸
4. í´ë”/ë¼ìš°í„° êµ¬ì¡° íŒŒì•…
5. ë¸Œë¦¿ì§€ í”„ë¡œí† ì½œ í™•ì¸ (í•„ìš” ì‹œ)
6. êµ¬í˜„ (ì›¹: shadcn/ui, ëª¨ë°”ì¼: ë„¤ì´í‹°ë¸Œ vs ì›¹ë·° ê²°ì •)
7. í…ŒìŠ¤íŠ¸ ì‘ì„± (data-testid)
8. ì „ì²´ ê²€í†  ë° ë¹Œë“œ í™•ì¸
