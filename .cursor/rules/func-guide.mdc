---
description: 기능 개발 가이드 (JS, API, 폼, 테스트)
globs:
alwaysApply: false
---

# 기능 개발 가이드

## 🔧 JS, HOOKS 조건

- 모든 기능 및 데이터는 해당 파일 안에서 처리하여, 다른 파일에 의존하지 않도록 구현할 것
- 의미를 담고 있는 구조화된 타입은 `src/commons/constants/enum.ts` 활용
- 최소한의 useState, useEffect를 사용할 것
- 커스텀 훅은 `src/hooks/` 폴더에 작성할 것

## 🔗 페이지 링크(이동) 조건

- 페이지 이동은 직접 하드코딩 하지 않고, `src/commons/constants/url.ts`를 통해서만 이동할 것
- Next.js의 useRouter 또는 Link 컴포넌트를 사용할 것

## 📝 폼, 검증 조건

- **react-hook-form**을 사용하여 폼을 구현할 것
- **zod**를 사용하여 검증로직을 구현할 것
- Form 컴포넌트는 `src/components/ui/form.tsx`를 활용할 것

## 🌐 API 조건

- **@tanstack/react-query**를 사용할 것
- `src/app/_providers/query-provider.tsx`에 셋팅된 QueryProvider를 사용할 것
- useQuery, useMutation 훅을 적극 활용할 것

## 🧩 UI 컴포넌트 조건

- `src/components/ui/` 폴더의 shadcn/ui 컴포넌트를 최대한 활용할 것
- 새로운 UI 컴포넌트가 필요한 경우, 기존 컴포넌트를 조합하여 구현할 것
- Button, Card, Input 등 기본 컴포넌트는 반드시 ui 폴더의 것을 사용할 것

## 🧪 TEST 조건

- TDD 기반으로 playwright 테스트를 먼저 작성할 것
- `playwright.config.ts` 설정은 변경하지 말 것
- playwright 테스트는 package.json의 scripts에 등록된 명령으로만 테스트 할 것
- playwright 테스트에 mock 데이터 사용하지 말고, 실제 데이터를 테스트로 사용할 것
- playwright 테스트에 API 테스트가 필요한 경우, 응답 결과를 하드코딩하지 말 것
- 테스트에 timeout 방식의 테스트말고, 다른 방식의 테스트가 가능하면 timeout 테스트는 사용하지 말 것
- timeout 테스트가 사용되어야만 하는 경우에는 timeout은 2000ms 미만으로 설정할 것
- 테스트시 사용되는 페이지이동(page.goto)은 baseUrl(호스트와 포트)을 포함하지 않고, 경로만 추가할 것
- 테스트시 사용되는 html,css(page.locator)는 Tailwind 클래스와의 충돌을 피하기 위해 **data-testid**를 지정하여 테스트 할 것

## 🔐 권한 분기 조건

### 페이지 GUARD
- "로그인 유저"를 기본값으로 하여, 모든 페이지 로그인 여부에 상관 없이 접속 가능하도록 할 것

### 액션 GUARD
- 로그인유저 시나리오: "로그인 유저"가 기본값이므로, 모든 기능의 로그인검사가드를 무시할 것
- 비로그인유저 시나리오: "로그인 유저"가 기본값이므로, 모든 기능에 로그인검사가드를 활성화할 것 (`window.**TEST_BYPASS** = false`)
