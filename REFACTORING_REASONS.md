# useAppStore.ts ë¦¬íŒ©í† ë§ ê·¼ê±°

## ğŸ”„ ë³€ê²½ ì‚¬í•­ ìš”ì•½

### Before (ê¸°ì¡´)
```typescript
import { create } from 'zustand';

export type Language = 'ko' | 'en'; // 2ê°œ ì–¸ì–´ë§Œ

export const useAppStore = create<AppState>((set) => ({
  user: null,
  language: 'en', // ê¸°ë³¸ ì–¸ì–´: English
  onboardingDone: false,
  setLanguage: (language) => set({ language }),
  login: (user) => set({ user }),
  logout: () => set({ user: null }),
  completeOnboarding: () => set({ onboardingDone: true }),
}));
```

### After (ê°œì„ )
```typescript
import { create } from 'zustand';
import { persist, createJSONStorage } from 'zustand/middleware';

export type Language = 'ko' | 'en' | 'ja' | 'zh' | 'es'; // 5ê°œ ì–¸ì–´

export const useAppStore = create<AppState>()(
  persist(
    (set) => ({
      user: null,
      language: 'ko', // ê¸°ë³¸ ì–¸ì–´: í•œêµ­ì–´
      onboardingDone: false,
      setLanguage: (language) => set({ language }),
      login: (user) => set({ user }),
      logout: () => set({ user: null }),
      completeOnboarding: () => set({ onboardingDone: true }),
    }),
    {
      name: 'safemeals-app-storage',
      storage: createJSONStorage(() => localStorage),
      partialize: (state) => ({
        language: state.language,
        onboardingDone: state.onboardingDone,
      }),
    }
  )
);
```

---

## ğŸ’¡ ë¦¬íŒ©í† ë§ ê·¼ê±° (ìƒì„¸)

### 1ï¸âƒ£ persist ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€ â­

**ë¬¸ì œì :**
```typescript
// ê¸°ì¡´: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ì–¸ì–´ ì„¤ì •ì´ ì´ˆê¸°í™”ë¨
const useAppStore = create<AppState>((set) => ({ ... }));
```

**ê°œì„ :**
```typescript
// persistë¡œ ê°ì‹¸ì„œ ìë™ ì €ì¥
const useAppStore = create<AppState>()(
  persist((set) => ({ ... }), { ... })
);
```

**ê·¼ê±°:**
- âœ… **UX ê°œì„ **: ì‚¬ìš©ìê°€ ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ë‹¤ìŒ ë°©ë¬¸ ì‹œì—ë„ ìœ ì§€ë¨
- âœ… **ìˆ˜ë™ êµ¬í˜„ ë¶ˆí•„ìš”**: localStorage ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°ë¥¼ ì§ì ‘ ì½”ë”©í•  í•„ìš” ì—†ìŒ
- âœ… **ìë™ ë™ê¸°í™”**: íƒ­ ê°„ ì–¸ì–´ ì„¤ì •ë„ ìë™ìœ¼ë¡œ ë™ê¸°í™”ë¨
- âœ… **í‘œì¤€ íŒ¨í„´**: Zustand ê³µì‹ ê¶Œì¥ ë°©ì‹

**ì‹¤ì œ íš¨ê³¼:**
```tsx
// ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤
1. ì‚¬ìš©ìê°€ ì–¸ì–´ë¥¼ 'æ—¥æœ¬èª'ë¡œ ë³€ê²½
2. ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìŒ
3. ë‹¤ì‹œ ì ‘ì† â†’ ìë™ìœ¼ë¡œ 'æ—¥æœ¬èª'ë¡œ í‘œì‹œ âœ¨
```

---

### 2ï¸âƒ£ Language íƒ€ì… í™•ì¥ (2ê°œ â†’ 5ê°œ)

**ë¬¸ì œì :**
```typescript
// ê¸°ì¡´: í•œêµ­ì–´, ì˜ì–´ë§Œ ì§€ì›
export type Language = 'ko' | 'en';
```

**ê°œì„ :**
```typescript
// 5ê°œ ì–¸ì–´ ì§€ì› + ëª…í™•í•œ ì£¼ì„
/**
 * ì§€ì› ì–¸ì–´ íƒ€ì…
 * - ko: í•œêµ­ì–´
 * - en: English
 * - ja: æ—¥æœ¬èª
 * - zh: ä¸­æ–‡
 * - es: EspaÃ±ol
 */
export type Language = 'ko' | 'en' | 'ja' | 'zh' | 'es';
```

**ê·¼ê±°:**
- âœ… **ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤**: SafeMealsëŠ” í•´ì™¸ ì—¬í–‰ìë¥¼ ìœ„í•œ ì•±ì´ë¯€ë¡œ ë‹¤êµ­ì–´ í•„ìˆ˜
- âœ… **translations.tsì™€ ì¼ì¹˜**: ì´ë¯¸ 5ê°œ ì–¸ì–´ ë²ˆì—­ì´ ì¤€ë¹„ë˜ì–´ ìˆìŒ
- âœ… **í™•ì¥ì„±**: ë‚˜ì¤‘ì— ì–¸ì–´ ì¶”ê°€ë„ ì‰¬ì›€
- âœ… **íƒ€ì… ì•ˆì „ì„±**: ì˜ëª»ëœ ì–¸ì–´ ì½”ë“œ ì‚¬ìš© ë°©ì§€

**ì‹¤ì œ íš¨ê³¼:**
```typescript
setLanguage('ja');  // âœ… OK
setLanguage('jp');  // âŒ íƒ€ì… ì—ëŸ¬! (ì˜¤íƒ€ ë°©ì§€)
```

---

### 3ï¸âƒ£ partialize ì˜µì…˜ (ì„ íƒì  ì €ì¥)

**ê°œì„ :**
```typescript
partialize: (state) => ({
  language: state.language,           // âœ… ì €ì¥
  onboardingDone: state.onboardingDone, // âœ… ì €ì¥
  // userëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ âŒ
}),
```

**ê·¼ê±°:**
- ğŸ”’ **ë³´ì•ˆ**: ì‚¬ìš©ì ì •ë³´(user)ëŠ” localStorageì— ì €ì¥í•˜ë©´ ì•ˆ ë¨
- ğŸ’¾ **ì„±ëŠ¥**: í•„ìš”í•œ ê²ƒë§Œ ì €ì¥í•˜ì—¬ ì €ì¥ ê³µê°„ ì ˆì•½
- âœ… **ì„ íƒì  ê´€ë¦¬**: 
  - `language`: ì €ì¥ í•„ìš” âœ…
  - `onboardingDone`: ì €ì¥ í•„ìš” âœ…
  - `user`: ë¯¼ê° ì •ë³´ì´ë¯€ë¡œ ì €ì¥ ì•ˆ í•¨ âŒ

**ì‹¤ì œ localStorage ë‚´ìš©:**
```json
{
  "state": {
    "language": "ko",
    "onboardingDone": true
  },
  "version": 0
}
```

---

### 4ï¸âƒ£ storage ëª…ì‹œì  ì„¤ì •

**ê°œì„ :**
```typescript
storage: createJSONStorage(() => localStorage),
```

**ê·¼ê±°:**
- âœ… **ëª…ì‹œì„±**: ì–´ë–¤ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ ëª…í™•
- âœ… **ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥**: ë‚˜ì¤‘ì— sessionStorageë‚˜ ë‹¤ë¥¸ ì €ì¥ì†Œë¡œ ì‰½ê²Œ ë³€ê²½ ê°€ëŠ¥
- âœ… **SSR ì•ˆì „**: Next.jsì—ì„œ ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ ì‹œ ì—ëŸ¬ ë°©ì§€
- âœ… **ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤**: Zustand ê³µì‹ ë¬¸ì„œ ê¶Œì¥ ë°©ì‹

**ì˜ˆì‹œ (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥):**
```typescript
// localStorage â†’ sessionStorageë¡œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´
storage: createJSONStorage(() => sessionStorage),
```

---

### 5ï¸âƒ£ ê¸°ë³¸ ì–¸ì–´ ë³€ê²½ (en â†’ ko)

**ë¬¸ì œì :**
```typescript
language: 'en', // ê¸°ë³¸ ì–¸ì–´: English
```

**ê°œì„ :**
```typescript
language: 'ko', // ê¸°ë³¸ ì–¸ì–´: í•œêµ­ì–´
```

**ê·¼ê±°:**
- ğŸ‡°ğŸ‡· **íƒ€ê²Ÿ ì‚¬ìš©ì**: SafeMealsëŠ” í•œêµ­ì¸ ì—¬í–‰ìê°€ ì£¼ íƒ€ê²Ÿ
- âœ… **UX**: ì²« ë°©ë¬¸ìê°€ í•œêµ­ì–´ë¡œ ë³´ëŠ” ê²Œ ë” ìì—°ìŠ¤ëŸ¬ì›€
- âœ… **ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­**: í•œêµ­ ì‹œì¥ ìš°ì„ 

---

### 6ï¸âƒ£ JSDoc ì£¼ì„ ì¶”ê°€

**ê°œì„ :**
```typescript
/**
 * ì „ì—­ ì•± ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´
 * 
 * @example
 * ```tsx
 * const language = useAppStore((state) => state.language);
 * const setLanguage = useAppStore((state) => state.setLanguage);
 * ```
 */
```

**ê·¼ê±°:**
- ğŸ“š **ìœ ì§€ë³´ìˆ˜ì„±**: ìƒˆë¡œìš´ ê°œë°œìê°€ ì½”ë“œë¥¼ ì‰½ê²Œ ì´í•´
- âœ… **IDE ì§€ì›**: VSCodeì—ì„œ ìë™ ì™„ì„± ì‹œ ì„¤ëª…ì´ í‘œì‹œë¨
- âœ… **ë¬¸ì„œí™”**: ë³„ë„ ë¬¸ì„œ ì—†ì´ë„ ì‚¬ìš©ë²•ì„ ì•Œ ìˆ˜ ìˆìŒ
- âœ… **ì˜ˆì‹œ ì½”ë“œ**: ë°”ë¡œ ë³µì‚¬í•´ì„œ ì‚¬ìš© ê°€ëŠ¥

**VSCodeì—ì„œ ë³´ì´ëŠ” ëª¨ìŠµ:**
```
useAppStore â“˜
ì „ì—­ ì•± ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´

Example:
  const language = useAppStore((state) => state.language);
  const setLanguage = useAppStore((state) => state.setLanguage);
```

---

## ğŸ“Š ì„±ëŠ¥ & ì‚¬ìš©ì„± ë¹„êµ

| í•­ëª© | Before | After | ê°œì„ ë„ |
|------|--------|-------|--------|
| ì–¸ì–´ ì €ì¥ | âŒ ì—†ìŒ | âœ… ìë™ | ğŸ”¥ğŸ”¥ğŸ”¥ |
| ì§€ì› ì–¸ì–´ | 2ê°œ | 5ê°œ | ğŸ”¥ğŸ”¥ |
| ë³´ì•ˆ | âš ï¸ ì·¨ì•½ | âœ… ì•ˆì „ | ğŸ”¥ğŸ”¥ğŸ”¥ |
| íƒ€ì… ì•ˆì „ì„± | âš ï¸ ë¶€ì¡± | âœ… ì™„ë²½ | ğŸ”¥ğŸ”¥ |
| ë¬¸ì„œí™” | âŒ ì—†ìŒ | âœ… ì™„ë²½ | ğŸ”¥ğŸ”¥ |
| ìœ ì§€ë³´ìˆ˜ì„± | âš ï¸ ë³´í†µ | âœ… ìš°ìˆ˜ | ğŸ”¥ğŸ”¥ğŸ”¥ |

---

## ğŸ¯ ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì–¸ì–´ ë³€ê²½ í›„ ìƒˆë¡œê³ ì¹¨

**Before:**
```
1. ì‚¬ìš©ì: ì–¸ì–´ë¥¼ æ—¥æœ¬èªë¡œ ë³€ê²½
2. ë¸Œë¼ìš°ì €: ìƒˆë¡œê³ ì¹¨ (F5)
3. ê²°ê³¼: âŒ ë‹¤ì‹œ Englishë¡œ ëŒì•„ê° (ë¶ˆí¸!)
```

**After:**
```
1. ì‚¬ìš©ì: ì–¸ì–´ë¥¼ æ—¥æœ¬èªë¡œ ë³€ê²½
2. ë¸Œë¼ìš°ì €: ìƒˆë¡œê³ ì¹¨ (F5)
3. ê²°ê³¼: âœ… æ—¥æœ¬èªê°€ ìœ ì§€ë¨ (í¸ë¦¬!)
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì—¬ëŸ¬ íƒ­ì—ì„œ ì–¸ì–´ ë³€ê²½

**Before:**
```
1. íƒ­ A: í•œêµ­ì–´ ì‚¬ìš© ì¤‘
2. íƒ­ B: ìƒˆë¡œ ì—´ë¦¼ â†’ Englishë¡œ ì‹œì‘
3. ê²°ê³¼: âŒ íƒ­ë§ˆë‹¤ ë‹¤ë¥¸ ì–¸ì–´ (í˜¼ë€)
```

**After:**
```
1. íƒ­ A: í•œêµ­ì–´ ì‚¬ìš© ì¤‘
2. íƒ­ B: ìƒˆë¡œ ì—´ë¦¼ â†’ í•œêµ­ì–´ë¡œ ì‹œì‘
3. ê²°ê³¼: âœ… ëª¨ë“  íƒ­ì´ ë™ê¸°í™” (ì¼ê´€ì„±)
```


### ì‹œë‚˜ë¦¬ì˜¤ 3: ì—¬ëŸ¬ í˜ì´ì§€ë¡œ ì˜®ê¸¸ ë•Œ 
ì˜ˆì‹œ) 
1. íƒ­ A: ì¼ë³¸ì–´ ì„¤ì • 
ë‹¤ìŒ ì„œë¹„ìŠ¤ ì´ìš© 
2. íƒ­ B: ìŠ¤í˜ì¸ì–´ë¡œ ë°”ë€œ

- ì‚¬ìš©ìê°€ ì–¸ì–´ì„¤ì •ì„ ë³€ê²½í•˜ì§€ ì•Šì„ ë™ì•ˆ  í”„ë¡œê·¸ë¨ ì´ìš©ì‹œ ì–¸ì–´ ì„¤ì •ì´ ë³€ê²½ì´ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ í•œë‹¤.
================================






---

## ğŸ”§ ê¸°ìˆ ì  ì´ì 

### 1. ì½”ë“œ í’ˆì§ˆ
```typescript
// Before: ìˆ˜ë™ìœ¼ë¡œ localStorage ê´€ë¦¬ í•„ìš”
useEffect(() => {
  const savedLang = localStorage.getItem('language');
  if (savedLang) setLanguage(savedLang);
}, []);

useEffect(() => {
  localStorage.setItem('language', language);
}, [language]);

// After: persistê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ âœ¨
// ì½”ë“œ ì—†ìŒ!
```

### 2. ì—ëŸ¬ ë°©ì§€
```typescript
// Before: localStorageê°€ ì—†ëŠ” í™˜ê²½ì—ì„œ ì—ëŸ¬
localStorage.getItem('language'); // âŒ SSRì—ì„œ ì—ëŸ¬!

// After: persistê°€ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
// SSR í™˜ê²½ì—ì„œë„ ì—ëŸ¬ ì—†ìŒ âœ…
```

### 3. íƒ€ì… ì•ˆì „ì„±
```typescript
// Before
setLanguage('japanese'); // âŒ ëŸ°íƒ€ì„ì—ì„œì•¼ ì—ëŸ¬ ë°œê²¬

// After
setLanguage('japanese'); // âœ… ì»´íŒŒì¼ íƒ€ì„ì— ì—ëŸ¬!
setLanguage('ja');       // âœ… OK
```

---

## ğŸ“ˆ ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ 

### ìƒˆë¡œìš´ ì–¸ì–´ ì¶”ê°€í•˜ê¸°

**Before:**
```typescript
// 1. Language íƒ€ì… ìˆ˜ì •
export type Language = 'ko' | 'en' | 'fr'; // ìˆ˜ë™ ì¶”ê°€

// 2. translations.ts ìˆ˜ì •
export const translations = {
  ko: { ... },
  en: { ... },
  fr: { ... }, // ì¶”ê°€
};

// 3. ì—¬ëŸ¬ ê³³ì—ì„œ ìˆ˜ì • í•„ìš”...
```

**After:**
```typescript
// 1. Language íƒ€ì…ì— ì¶”ê°€ë§Œ í•˜ë©´ ë!
export type Language = 'ko' | 'en' | 'ja' | 'zh' | 'es' | 'fr';

// 2. TypeScriptê°€ ëˆ„ë½ëœ ë²ˆì—­ì„ ìë™ìœ¼ë¡œ ì•Œë ¤ì¤Œ âœ¨
// 3. ì»´íŒŒì¼ ì—ëŸ¬ë¡œ ë¹ ì§„ ë¶€ë¶„ì„ í™•ì¸ ê°€ëŠ¥
```

---

## âœ¨ ê²°ë¡ 

### í•µì‹¬ ê°œì„  ì‚¬í•­
1. **ì‚¬ìš©ì ê²½í—˜** â¬†ï¸ - ì–¸ì–´ ì„¤ì •ì´ ê³„ì† ìœ ì§€ë¨
2. **ê°œë°œì ê²½í—˜** â¬†ï¸ - ì½”ë“œê°€ ë” ê°„ê²°í•˜ê³  ì•ˆì „í•¨
3. **ìœ ì§€ë³´ìˆ˜ì„±** â¬†ï¸ - í™•ì¥í•˜ê¸° ì‰½ê³  ë²„ê·¸ê°€ ì ìŒ
4. **ë³´ì•ˆ** â¬†ï¸ - ë¯¼ê° ì •ë³´ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ
5. **íƒ€ì… ì•ˆì „ì„±** â¬†ï¸ - ì»´íŒŒì¼ íƒ€ì„ì— ì—ëŸ¬ ë°œê²¬

### ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ì¤€ìˆ˜
- âœ… Zustand ê³µì‹ ê¶Œì¥ íŒ¨í„´
- âœ… Next.js SSR ì•ˆì „
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€
- âœ… ì™„ë²½í•œ ë¬¸ì„œí™”

---

**ê²°ê³¼: ë” ì•ˆì „í•˜ê³ , ë” í¸ë¦¬í•˜ê³ , ë” ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰¬ìš´ ì½”ë“œ! ğŸ‰**

